\chapter{Preface}

\begin{shaded}
\noindent
\textbf{Status as of 2016-12-26.} We have updated the manuscript to track changes to package \pkg{ggspectra}. This required/made possible some changes to the code in Chapter \ref{chap:plotting}. In addition changes in recent versions of \pkg{ggtern} allowed to easily improve one of the colour plotting examples. Although \pkg{photobiology} has also been updated after the last ``printing'' the changes introduced did not require any changes to the code examples in this handbook. The book has been built today using current versions of all packages.
\end{shaded}

\begin{shaded}
\noindent
\textbf{Status as of 2016-10-28.} We have updated the manuscript to track package updates since the previous version uploaded nearly three months ago, and added examples of the new functionality added to packages \pkg{ggspectra}, \pkg{ggrepel}, and \pkg{ggplot2}. Now seven of the packages in the suite are in CRAN. Package \pkg{photobiology} has gone through a major update of the astronomy-related functions. The user interface has changed a little. The values returned are slightly different as a different algorithm has been implemented. Package \pkg{photobiologyInOut} has been expanded in its scope. Bugs have been fixed, but most of them only affected borderline cases.

Some errors in the text of the manuscript have been corrected. During the last couple of months more time was spent in trying to get all the packages in the suite ready for submission to CRAN than on expanding and revising the text of this book. However, quite many of the code examples in the book have been simplified or updated to make use of all the improvements to the packages. Many new plotting examples were added.
\end{shaded}

\begin{shaded}
\noindent
\textbf{Status as of 2018-03-09.} We have updated the manuscript to track package updates since the previous version. Now ten of the packages in the suite are in CRAN. Package \pkg{photobiology} has gone through a second major update of the astronomy-related functions using much more efficient and precise algorithms. Most summary methods previously available only for individual spectra have been implemented for collections of spectra removing the need for loops in user scripts. The data-only packages have been revised in their organization and many new data sets added. The documentation has been revised and some bugs corrected with nearly four thousand test cases written to ensure the reliability of the code and facilitate future revisions. The code for handling of metadata attributes has been reorganized and additional metadata is now stored and displayed. A new class ``calibration\_spct'' was added.

Chapter \emph{Arithmetic operators and mathematical functions} has been thoroughly updated to describe all the operators and functions currently available in the suite. The text of other chapters has been in places revised, but some of the chapters do not yet describe all the functionality currently available in the suite. All code examples in the book have been checked against current versions of the packages. Only a few changes were necessary, mostly in relation to the re-naming of data objects in the data-only packages of the suite.

In the last year most of the effort has gone into getting all the packages ready for submission to CRAN, with the expectation that once released no significant code-breaking changes to the interface will be necessary. A stable interface is crucial for the long-term usefulness of the book once formally published. Also the package vignettes and documentation have been improved. The R for Photobiology web site now contains the documentation for all packages in HTML format.

The packages and to some extent this book manuscript are gradually becoming more popular. The current update will hopefully help those exploring the use of the suite of packages.
\end{shaded}

\begin{shaded}
\noindent
\textbf{Status as of 2018-10-09.} I have continued revising the packages but with code-breaking changes only related to the names of some of the values computed in the ggplot statistics. A few examples were affected by these changes and have been revised.
\end{shaded}


\begin{shaded}
\noindent
\textbf{Status as of 2020-05-18.} I have continued revising the packages but with very few code-breaking changes. A change in package `tibble' made necessary changes in two lines of example code.
\end{shaded}

\begin{shaded}
\noindent
\textbf{Status as of 2021-04-08.} I have continued revising the packages but with very few code-breaking changes. The data previously included in package \pkg{photobiologyReflectors} are nor in package \pkg{photobiologyFilters}. The updates to the packages have to some extent modified the results of computations, such columns names or how plots looks. Most of these changes are small. On the other, the updates have added functionality that either makes coding some operations simpler, or allow some new computations. These improvements are not yet reflected in the code examples in the book at this time.
\end{shaded}

This handbook describes how to use R as a tool for doing calculations related to research in photobiology and other related fields. Photobiology is the branch of science that studies the interactions of living organisms with visible and ultraviolet radiation. Many of the most frequently used calculations are either related to the characterization of radiation and of the responses of organisms to radiation. We use a broad definition of photobiology that includes the light environment of organisms and its description as well as characterization and design of treatment conditions. We briefly touch on atmospheric radiation physics and optics. We emphasize the spectral characterization of visible and ultraviolet radiation in relation to photobiology but many of the principles and tools are relevant to spectral measurements in other disciplines like chemistry, biochemistry, meteorology and remote sensing.

The R-code examples in this handbook make frequent use of the `r4photobiology' suite of R packages, developed by the author. Other packages are also described: XXX.

The basic theory needed to understand the purpose and use of the different calculations is presented in Part~\ref{part:theory} (p.~\pageref{part:theory} ss.). This first part is simple and concise, and full understanding of the subject matter will require previous experience or further reading \autocite[e.g.][]{Aphalo2012,Bjoern2015}.
R packages and data analysis work flows are described in Part~~\ref{part:tools} (p.~\pageref{part:tools} ss.).
Specific computations are described together with R-code examples in Part~\ref{part:cookbook} (p.~\pageref{part:cookbook} ss.).
Part~\ref{part:foreign} (p.~\pageref{part:foreign} ss.) includes chapters dedicated to reading and writing data in \emph{foreign} formats, including direct acquisition from spectrometer and other measuring instruments. Part~\ref{part:data} (p.~\pageref{part:data} ss.) gives a brief overview of the data sets available in R packages and in on-line repositories.

Although this handbook includes many different recipes, it is not comprehensive in covering all the functionality of the packages. The packages themselves include \emph{User Guides} and help pages describing their functionality in detail. The documentation is available as a web site at \url{http://docs.r4photobiology.info}. A series of articles describing specific aspects of the use of the suite is being published in the \href{http://uv4plants.org/publications/uv4plants-bulletin-published-issues/}{UV4Plants Bulletin}.

This handbook assumes that readers are already familiar with the R language and in Part~I that they are familiar with Physics and Mathematics, including basic calculus and geometry.

\section{Typographical conventions}

Code examples are typeset in monospaced font and syntax highlighted in colour. References to R language elements---i.e.\ R `code'---in the main text are also in a \code{monospaced} font but in black on a faint background. Package names are typeset between single quotes in a \pkg{sans serif} font.

We\Attention{} use the icon exemplified in the page margin next to this paragraph to highlight contents that require special attention because they are frequent causes of errors and problems.

We\Advanced{} use the icon exemplified in the page margin next to this paragraph to highlight contents that is advanced and will require the reader to linger on it to get a deep understanding---and which can, alternatively, be skipped on first reading by those readers which want a faster path to learning to do simpler calculations.

\section{Acknowledgements}

We thank Stefano Catola, Paula Salonen, David Israel, Neha Rai, Tendry Randriamanana, Saara Hartikainen, Christian Bianchi-Str{\o}mme, Fang Wang and \ldots for very useful comments and suggestions on the draft manuscript and examples used in training schools. The friendly and generous R community also deserves a big `Thank you!'.

Helsinki, August 2020.

The authors. 